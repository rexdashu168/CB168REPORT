<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æŠ•è³‡ç ”å ±åŠ©æ‰‹ Pro Max</title>
<style>
    :root {
        /* æ¥µç°¡é…è‰²ç³»çµ± */
        --primary: #6366f1;       /* ä¸»è‰²ï¼šç§‘æŠ€ç´« */
        --primary-light: #e0e7ff;
        --accent-green: #10b981;  /* è¼”åŠ©ï¼šæ¼²/ç”¢æ¥­/åˆ©å¤š */
        --accent-orange: #f59e0b; /* è¼”åŠ©ï¼šå¤–é›»/é‡é» */
        --accent-red: #ef4444;    /* è¼”åŠ©ï¼šè·Œ/é¢¨éšª */
        
        --bg-main: #f8f9fa;       /* èƒŒæ™¯ï¼šæ¥µæ·ºç°ï¼Œæ¯”ç´”ç™½è­·çœ¼ */
        --bg-card: #ffffff;
        
        --text-main: #111827;
        --text-sub: #6b7280;
        
        /* é™°å½±èˆ‡åœ“è§’ */
        --shadow-soft: 0 10px 40px -10px rgba(0,0,0,0.08);
        --shadow-card: 0 4px 12px rgba(0,0,0,0.03);
        --radius-l: 24px;
        --radius-m: 16px;
        --radius-s: 12px;
    }

    body { 
        font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "PingFang TC", sans-serif; 
        background: var(--bg-main); 
        color: var(--text-main); 
        margin: 0; 
        padding-bottom: 90px; /* é¿é–‹åº•éƒ¨å°èˆª */
        -webkit-tap-highlight-color: transparent; 
        line-height: 1.6;
    }
    
    /* å‹•ç•« */
    .view { display: none; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); min-height: 100vh; }
    .view.active { display: block; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* === Header: ä¹¾æ·¨ã€é€æ°£ === */
    .header { 
        background: rgba(255,255,255,0.9); 
        backdrop-filter: blur(10px);
        padding: 20px; 
        position: sticky; 
        top: 0; 
        z-index: 50; 
        display: flex; 
        align-items: center; 
        border-bottom: 1px solid rgba(0,0,0,0.05);
    }
    .header h1 { margin: 0; font-size: 20px; flex-grow: 1; text-align: center; font-weight: 700; letter-spacing: -0.5px; color: var(--text-main); }
    .btn-back { background: none; border: none; font-size: 24px; cursor: pointer; padding: 0 10px; color: var(--text-main); }

    /* === é¦–é æ’ç‰ˆ (Magazine Style) === */
    .container { padding: 20px; max-width: 600px; margin: 0 auto; }
    
    /* å…©å¤§æ——è‰¦åŠŸèƒ½ (ç”¢æ¥­ & å¤–é›») */
    .hero-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px; }
    .hero-card {
        background: var(--bg-card);
        border-radius: var(--radius-l);
        padding: 24px 20px;
        box-shadow: var(--shadow-soft);
        position: relative;
        overflow: hidden;
        cursor: pointer;
        transition: transform 0.2s;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 140px;
    }
    .hero-card:active { transform: scale(0.98); }
    .hero-icon { font-size: 36px; margin-bottom: 12px; }
    .hero-title { font-size: 18px; font-weight: 700; margin-bottom: 4px; }
    .hero-sub { font-size: 13px; color: var(--text-sub); opacity: 0.8; }
    
    /* é¡è‰²ä¸»é¡Œ */
    .card-ind { background: linear-gradient(145deg, #ffffff 0%, #f0fdf4 100%); border: 1px solid #d1fae5; }
    .card-ind .hero-title { color: #065f46; }
    .card-news { background: linear-gradient(145deg, #ffffff 0%, #fffbeb 100%); border: 1px solid #fcd34d; }
    .card-news .hero-title { color: #92400e; }

    /* æ¬¡è¦åŠŸèƒ½å€ (ç ”å ±ç¯©é¸) */
    .section-title { font-size: 18px; font-weight: 700; margin: 24px 0 12px; display: flex; align-items: center; gap: 8px; }
    .filter-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    .filter-card {
        background: var(--bg-card);
        padding: 16px;
        border-radius: var(--radius-m);
        text-align: left;
        box-shadow: var(--shadow-card);
        cursor: pointer;
        border: 1px solid #f3f4f6;
    }
    .filter-head { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; font-weight: 600; color: var(--text-main); }
    .filter-desc { font-size: 12px; color: var(--text-sub); }

    /* === åˆ—è¡¨æ¨£å¼ (List View) === */
    .report-item {
        background: var(--bg-card);
        border-radius: var(--radius-m);
        padding: 20px;
        margin-bottom: 16px;
        box-shadow: var(--shadow-card);
        cursor: pointer;
        transition: all 0.2s;
    }
    .report-item:active { background: #f9fafb; }
    .r-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .r-badge { font-size: 11px; padding: 4px 10px; border-radius: 20px; font-weight: 600; letter-spacing: 0.5px; }
    .bg-buy { background: #ecfdf5; color: #059669; }
    .bg-hold { background: #fef3c7; color: #d97706; }
    .r-title { font-size: 16px; font-weight: 700; margin-bottom: 6px; line-height: 1.4; }
    .r-info { font-size: 13px; color: var(--text-sub); display: flex; gap: 12px; }

    /* === ğŸŒŸ ç ”å ±è©³æƒ…ï¼šèŠå¤©å®¤æµ (Chat Flow UI) === */
    .chat-container { max-width: 600px; margin: 0 auto; padding: 20px; display: flex; flex-direction: column; gap: 24px; }
    
    /* æ³¡æ³¡å…±ç”¨æ¨£å¼ */
    .chat-bubble {
        background: var(--bg-card);
        border-radius: 0 var(--radius-l) var(--radius-l) var(--radius-l); /* å·¦ä¸Šè§’å°–è§’ */
        padding: 24px;
        box-shadow: var(--shadow-soft);
        position: relative;
        animation: popIn 0.5s ease backwards;
    }
    .chat-bubble::before {
        content: ''; position: absolute; top: 0; left: -8px; width: 8px; height: 20px;
        background: radial-gradient(circle at 0 100%, transparent 8px, var(--bg-card) 9px);
    }
    @keyframes popIn { from { opacity: 0; transform: scale(0.95) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

    /* æ³¡æ³¡é¡å‹ï¼šMeta (ç¬¬ä¸€å‰‡) */
    .bubble-meta { border-left: 4px solid var(--primary); }
    .meta-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 13px; color: var(--text-sub); }
    .meta-big { font-size: 24px; font-weight: 800; color: var(--text-main); margin-bottom: 4px; }
    .meta-sub { font-size: 14px; color: var(--primary); font-weight: 600; }

    /* æ³¡æ³¡é¡å‹ï¼šé‡é» (Summary) */
    .bubble-summary { background: #fdf2f8; color: #831843; border: none; } 
    .bubble-summary::before { background: radial-gradient(circle at 0 100%, transparent 8px, #fdf2f8 9px); }
    
    /* æ³¡æ³¡é¡å‹ï¼šæ¢åˆ—å…§å®¹ (List) */
    .bubble-content h3 { margin: 0 0 16px 0; font-size: 15px; color: var(--text-sub); text-transform: uppercase; letter-spacing: 1px; }
    .point-item { display: flex; gap: 12px; margin-bottom: 16px; align-items: flex-start; }
    .point-icon { flex-shrink: 0; width: 24px; height: 24px; background: var(--primary-light); color: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; margin-top: 2px; }
    .point-text { font-size: 15px; line-height: 1.7; color: #374151; }

    /* === âš¡ å¤–é›»å¿«è¨Šï¼šç²¾ç·»ç‰ˆé¢ === */
    .news-card-lg {
        background: var(--bg-card);
        border-radius: var(--radius-l);
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: var(--shadow-soft);
    }
    .news-source-row { display: flex; align-items: center; gap: 8px; margin-bottom: 16px; }
    .news-logo { width: 32px; height: 32px; background: #000; color: #fff; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 10px; }
    .news-name { font-weight: 700; font-size: 14px; }
    .news-time { margin-left: auto; font-size: 12px; color: var(--text-sub); }
    
    .news-main-title { font-size: 18px; font-weight: 700; line-height: 1.4; margin-bottom: 20px; }
    
    /* å¤–é›»é‡é»æ¸…å–® */
    .news-points { padding-left: 0; margin: 0; list-style: none; }
    .news-point { 
        position: relative; 
        padding-left: 24px; 
        margin-bottom: 16px; 
        font-size: 15px; 
        line-height: 1.6; 
        color: #4b5563; 
    }
    .news-point::before {
        content: '';
        position: absolute;
        left: 0;
        top: 8px;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--accent-orange);
    }
    .sentiment-tag { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 12px; font-weight: bold; margin-top: 12px; }
    .sent-pos { background: #ecfdf5; color: #047857; }

    /* åº•éƒ¨å°èˆª (iOS Style) */
    .nav { 
        position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
        width: 90%; max-width: 400px;
        background: rgba(255,255,255,0.9); backdrop-filter: blur(20px);
        border-radius: 32px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        display: flex; justify-content: space-between; padding: 12px 30px; z-index: 100;
        border: 1px solid rgba(255,255,255,0.5);
    }
    .nav-item { text-align: center; color: #9ca3af; cursor: pointer; transition: 0.2s; }
    .nav-item.active { color: var(--primary); transform: translateY(-2px); }
    .nav-icon { font-size: 24px; display: block; margin-bottom: 2px; }
    .nav-label { font-size: 10px; font-weight: 500; }
</style>
</head>
<body>

<div id="home" class="view active">
    <div class="header">
        <h1>ä»Šæ—¥ç ”å ±è§€é»</h1>
    </div>

    <div class="container">
        <div class="hero-grid">
            <div class="hero-card card-ind" onclick="app.go('industryView')">
                <div class="hero-icon">ğŸ­</div>
                <div>
                    <div class="hero-title">ç”¢æ¥­ç™¾ç§‘</div>
                    <div class="hero-sub">ä¾›æ‡‰éˆåœ°ä½èˆ‡å„ªå‹¢</div>
                </div>
            </div>
            <div class="hero-card card-news" onclick="app.go('newsView')">
                <div class="hero-icon">âš¡</div>
                <div>
                    <div class="hero-title">å¤–é›»å¿«è¨Š</div>
                    <div class="hero-sub">WSJ / Bloomberg</div>
                </div>
            </div>
        </div>

        <div class="section-title">ğŸ“ åœ‹å…§åˆ¸å•†å ±å‘Š</div>
        <div class="filter-grid">
            <div class="filter-card" onclick="app.filter('new')">
                <div class="filter-head"><span style="color:#6366f1">â—</span> æœ€æ–°ç™¼å¸ƒ</div>
                <div class="filter-desc">ä»Šæ—¥æ›´æ–° 5 ä»½</div>
            </div>
            <div class="filter-card" onclick="app.filter('buy')">
                <div class="filter-head"><span style="color:#10b981">â—</span> è©•ç­‰è²·é€²</div>
                <div class="filter-desc">Strong Buy</div>
            </div>
            <div class="filter-card" onclick="app.filter('target')">
                <div class="filter-head"><span style="color:#ef4444">â—</span> ç›®æ¨™åƒ¹èª¿å‡</div>
                <div class="filter-desc">æ½›åœ¨ç©ºé–“å¤§</div>
            </div>
            <div class="filter-card" onclick="app.filter('hot')">
                <div class="filter-head"><span style="color:#f59e0b">â—</span> ç†±é–€å€‹è‚¡</div>
                <div class="filter-desc">äº¤æ˜“é‡å¤§</div>
            </div>
        </div>

        <div class="section-title">ğŸ“Œ é‡é»æ‘˜è¦</div>
        <div id="home-list"></div>
    </div>
</div>

<div id="listView" class="view">
    <div class="header">
        <button class="btn-back" onclick="app.back()">â†</button>
        <h1 id="list-title">å ±å‘Šåˆ—è¡¨</h1>
        <div style="width:40px"></div>
    </div>
    <div class="container" id="full-list-container"></div>
</div>

<div id="detailView" class="view">
    <div class="header">
        <button class="btn-back" onclick="app.back()">â†</button>
        <h1>æ·±åº¦è§€é»</h1>
        <div style="width:40px"></div>
    </div>
    <div class="chat-container" id="chat-content"></div>
</div>

<div id="newsView" class="view">
    <div class="header">
        <button class="btn-back" onclick="app.back()">â†</button>
        <h1>Global News</h1>
        <div style="width:40px"></div>
    </div>
    <div class="container" id="news-content"></div>
</div>

<div id="industryView" class="view">
    <div class="header" style="background:#f0fdf4;">
        <button class="btn-back" onclick="app.back()">â†</button>
        <h1 style="color:#065f46">ç”¢æ¥­èº«åˆ†è­‰</h1>
        <div style="width:40px"></div>
    </div>
    <div class="container">
        <input type="text" placeholder="è¼¸å…¥ 2330 æˆ– å°ç©é›»..." style="width:100%; padding:16px; border:none; border-radius:16px; background:#fff; box-shadow:var(--shadow-card); font-size:16px; outline:none;" onkeyup="app.searchInd(this.value)">
        <div id="ind-result" style="margin-top:20px;"></div>
    </div>
</div>

<div class="nav">
    <div class="nav-item active" onclick="app.go('home')">
        <span class="nav-icon">ğŸ </span>
        <div class="nav-label">é¦–é </div>
    </div>
    <div class="nav-item" onclick="app.go('newsView')">
        <span class="nav-icon">âš¡</span>
        <div class="nav-label">å¤–é›»</div>
    </div>
    <div class="nav-item" onclick="app.go('industryView')">
        <span class="nav-icon">ğŸ­</span>
        <div class="nav-label">ç”¢æ¥­</div>
    </div>
</div>

<script>
// === è³‡æ–™æ¨¡æ“¬ (ä¾ç…§æ‚¨çš„ CSV çµæ§‹) ===
const DB_REPORTS = [
    { 
        id: 1, date: "2025/11/19", company: "è‡´èŒ‚", code: "2360", broker: "æ°¸è±æŠ•é¡§", analyst: "é™³åˆ†æå¸«",
        rating: "è²·é€²", target: "520", prevTarget: "480",
        title: "AI æ¸¬è©¦è¨­å‚™éœ€æ±‚å¼·å‹ï¼Œè¨‚å–®èƒ½è¦‹åº¦é”æ˜å¹´",
        summary: "å—æƒ æ–¼ Nvidia Blackwell æ™¶ç‰‡æ¸¬è©¦éœ€æ±‚ï¼Œç³»çµ±ç´šæ¸¬è©¦ (SLT) è¨­å‚™å‡ºè²¨æ”¾é‡ï¼Œç‡Ÿæ”¶å‹•èƒ½å¼·å‹ã€‚",
        // é€™è£¡æ¨¡æ“¬æ‚¨æåˆ°çš„ã€Œè©³ç´°å…§å®¹åº«ã€æ¬„ä½ï¼ŒåŒ…å«å¤šé»æ¢åˆ—
        contentPoints: [
            "Q3 è²¡å ±å„ªæ–¼é æœŸï¼šå–®å­£ EPS 3.5å…ƒï¼Œæ¯›åˆ©ç‡å—æƒ ç”¢å“çµ„åˆå„ªåŒ–æå‡è‡³ 55%ã€‚",
            "SLT è¨­å‚™ç¨å®¶ä¾›æ‡‰ï¼šéš¨è‘— CoWoS ç”¢èƒ½é–‹å‡ºï¼Œå¾Œæ®µæ¸¬è©¦è¨­å‚™éœ€æ±‚çˆ†ç™¼ï¼Œè‡´èŒ‚ç‚ºä¸»è¦å—æƒ è€…ã€‚",
            "Photonics æ¥­å‹™ï¼šå…‰é€šè¨Šæ¸¬è©¦è¨­å‚™éš¨ CPO è¶¨å‹¢æˆé•·ï¼Œæ˜å¹´ç‡Ÿæ”¶ä½”æ¯”å¯æœ›çªç ´ 10%ã€‚",
            "2026 å±•æœ›ï¼šè¨‚å–®å·²æ’è‡³æ˜å¹´ä¸‹åŠå¹´ï¼Œé ä¼°å…¨å¹´ç‡Ÿæ”¶æˆé•· 25%ã€‚"
        ]
    },
    { 
        id: 2, date: "2025/11/19", company: "è¯ç¢©", code: "2357", broker: "å‡±åŸºæŠ•é¡§", analyst: "æ—ç ”ç©¶å“¡",
        rating: "è²·é€²", target: "700", prevTarget: "650",
        title: "GB200 ä¼ºæœå™¨é–‹å§‹å‡ºè²¨ï¼ŒPC å¾©ç”¦å„ªæ–¼é æœŸ",
        summary: "AI PC å¸‚å ç‡ç¶­æŒç¬¬ä¸€ï¼Œä¼ºæœå™¨æ¥­å‹™å°‡æˆç‚ºæ˜å¹´ä¸»è¦æˆé•·å¼•æ“ã€‚",
        contentPoints: [
            "ä¼ºæœå™¨ç‡Ÿæ”¶ç¿»å€ï¼šé è¨ˆ 2025 å¹´ä¼ºæœå™¨ç‡Ÿæ”¶ä½”æ¯”å°‡é” 20%ï¼Œå…¶ä¸­ 80% ç‚º AI ä¼ºæœå™¨ã€‚",
            "ç²åˆ©çµæ§‹æ”¹å–„ï¼šå•†ç”¨ PC ä½”æ¯”æå‡ï¼ŒæŠµéŠ·æ¶ˆè²»æ€§é›»å­æ·¡å­£å½±éŸ¿ã€‚",
            "è©•åƒ¹ï¼šç›®å‰æœ¬ç›Šæ¯”åƒ… 15 å€ï¼Œä½æ–¼åŒæ¥­å¹³å‡ï¼Œè©•åƒ¹å…·å¸å¼•åŠ›ã€‚"
        ]
    },
    {
        id: 3, date: "2025/11/18", company: "å°ç©é›»", code: "2330", broker: "é«˜ç››", analyst: "Bill Liu",
        rating: "è²·é€²", target: "1350", prevTarget: "1280",
        title: "3å¥ˆç±³ç”¢èƒ½æŒçºŒæ»¿è¼‰ï¼Œæ¼²åƒ¹æ•ˆæ‡‰æ˜å¹´é¡¯ç¾",
        summary: "å…ˆé€²è£½ç¨‹è­·åŸæ²³æ·±åšï¼Œé™¤äº† AI éœ€æ±‚å¤–ï¼Œæ‰‹æ©Ÿèˆ‡ HPC éœ€æ±‚äº¦åŒæ­¥å¢æº«ã€‚",
        contentPoints: [
            "ç”¢èƒ½åƒç·Šï¼š3nm/5nm ç”¢èƒ½åˆ©ç”¨ç‡è¶…é 100%ï¼Œå®¢æˆ¶æ’éšŠè‡³ 2026 å¹´ã€‚",
            "æµ·å¤–æ“´å» é †åˆ©ï¼šç¾åœ‹äºåˆ©æ¡‘é‚£å» è‰¯ç‡å·²è¿½ä¸Šå°ç£ï¼Œæ¶ˆé™¤å¸‚å ´ç–‘æ…®ã€‚",
            "è³‡æœ¬æ”¯å‡ºï¼šé ç¶­æŒ 300-320 å„„ç¾å…ƒé«˜æª”ï¼Œé¡¯ç¤ºå°æœªä¾†éœ€æ±‚å……æ»¿ä¿¡å¿ƒã€‚"
        ]
    }
];

// å¤–é›»è³‡æ–™ (æ¨¡æ“¬å¤šé‡é»)
const DB_NEWS = [
    {
        source: "Bloomberg", time: "10:45", title: "Nvidia GB200 ä¾›æ‡‰éˆè¿½è¹¤ï¼šå‡ºè²¨é †æš¢",
        points: [
            "ä¾›æ‡‰éˆæ¶ˆæ¯æŒ‡å‡ºï¼ŒB200 éç†±å•é¡Œå·²ç²å¾—è§£æ±ºï¼Œé´»æµ·èˆ‡å»£é”å°‡æ–¼ 12 æœˆæº–æ™‚å‡ºè²¨ã€‚",
            "å¾®è»Ÿèˆ‡ Meta æŒçºŒè¿½åŠ è¨‚å–®ï¼Œä¸¦æœªå‡ºç¾ç å–®è·¡è±¡ã€‚",
            "åˆ†æå¸«é ä¼°ï¼ŒBlackwell æ¶æ§‹æ™¶ç‰‡å°‡è²¢ç» Nvidia æ˜å¹´ 60% ä»¥ä¸Šç‡Ÿæ”¶ã€‚"
        ],
        sentiment: "Positive"
    },
    {
        source: "WSJ", time: "09:30", title: "å·æ™®é—œç¨…æ”¿ç­–å°äºæ´²ç§‘æŠ€æ¥­çš„æ½›åœ¨å½±éŸ¿",
        points: [
            "è‹¥å¯¦æ–½ 60% å…¨é¢é—œç¨…ï¼Œç­†é›»èˆ‡æ‰‹æ©Ÿä»£å·¥å» æ¯›åˆ©ç‡æå—å‰µã€‚",
            "å°ç£åŠå°é«”æ¥­å› å…·ä¸å¯æ›¿ä»£æ€§ï¼Œé è¨ˆå—å½±éŸ¿ç¨‹åº¦è¼ƒå°ã€‚",
            "éƒ¨åˆ†å» å•†å·²åŠ é€Ÿæ±å—äºèˆ‡å¢¨è¥¿å“¥ä½ˆå±€ï¼Œä»¥è¦é¿åœ°ç·£æ”¿æ²»é¢¨éšªã€‚"
        ],
        sentiment: "Neutral"
    }
];

// ç”¢æ¥­è³‡æ–™
const DB_IND = [
    { code: "2360", name: "è‡´èŒ‚", main: "å„€å™¨è¨­å‚™", sub: "é‡æ¸¬è‡ªå‹•åŒ–", pos: "å…¨çƒé›»æºæ¸¬è©¦é¾é ­", desc: "è¿‘å¹´æˆåŠŸåˆ‡å…¥åŠå°é«” SLT æ¸¬è©¦ï¼Œèˆ‡å„å¤§æ™¶ç‰‡å» åˆä½œç·Šå¯†ã€‚" },
    { code: "2357", name: "è¯ç¢©", main: "é›»è…¦å“ç‰Œ", sub: "PC/ä¼ºæœå™¨", pos: "æ¿å¡é¾é ­", desc: "ROG å“ç‰Œæº¢åƒ¹åŠ›å¼·ï¼ŒAI ä¼ºæœå™¨æˆé•·å¿«é€Ÿã€‚" }
];

// === æ‡‰ç”¨æ ¸å¿ƒ ===
const app = {
    history: ['home'],

    init: function() {
        // æ¸²æŸ“é¦–é æ‘˜è¦
        const container = document.getElementById('home-list');
        container.innerHTML = DB_REPORTS.map(d => `
            <div class="report-item" onclick="app.showDetail(${d.id})" style="padding:16px; margin-bottom:10px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-weight:700;">${d.company} ${d.code}</span>
                    <span class="r-badge ${d.rating==='è²·é€²'?'bg-buy':'bg-hold'}">${d.rating}</span>
                </div>
                <div style="font-size:13px; color:#666; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${d.title}</div>
            </div>
        `).join('');

        // æ¸²æŸ“å¤–é›»
        this.renderNews();
    },

    // --- é é¢è·³è½‰ ---
    go: function(viewId) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
        if(this.history[this.history.length-1] !== viewId) this.history.push(viewId);
        window.scrollTo(0,0);
        
        // æ›´æ–° Nav ç‹€æ…‹
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        if(viewId === 'home') document.querySelectorAll('.nav-item')[0].classList.add('active');
        if(viewId === 'newsView') document.querySelectorAll('.nav-item')[1].classList.add('active');
        if(viewId === 'industryView') document.querySelectorAll('.nav-item')[2].classList.add('active');
    },

    back: function() {
        if(this.history.length > 1) {
            this.history.pop();
            this.go(this.history.pop());
        } else {
            this.go('home');
        }
    },

    // --- åŠŸèƒ½ï¼šç¯©é¸å ±å‘Š ---
    filter: function(type) {
        let data = DB_REPORTS;
        let title = "æ‰€æœ‰å ±å‘Š";
        if(type === 'buy') { data = DB_REPORTS.filter(x => x.rating === 'è²·é€²'); title = "è©•ç­‰è²·é€²"; }
        
        document.getElementById('list-title').innerText = title;
        document.getElementById('full-list-container').innerHTML = data.map(d => `
            <div class="report-item" onclick="app.showDetail(${d.id})">
                <div class="r-header">
                    <div>
                        <span style="font-size:18px; font-weight:700; margin-right:8px;">${d.company}</span>
                        <span style="color:#9ca3af; font-weight:500;">${d.code}</span>
                    </div>
                    <span class="r-badge ${d.rating==='è²·é€²'?'bg-buy':'bg-hold'}">${d.rating} TP:${d.target}</span>
                </div>
                <div class="r-title">${d.title}</div>
                <div class="r-info">
                    <span>${d.broker} Â· ${d.analyst}</span>
                    <span>${d.date}</span>
                </div>
            </div>
        `).join('');
        
        this.go('listView');
    },

    // --- æ ¸å¿ƒï¼šèŠå¤©å®¤é¢¨æ ¼è©³æƒ…é  (Chat UI) ---
    showDetail: function(id) {
        const d = DB_REPORTS.find(x => x.id === id);
        if(!d) return;

        const container = document.getElementById('chat-content');
        // ä½¿ç”¨ setTimeout ç‡Ÿé€ ä¸€é»é»ã€Œè¼‰å…¥ä¸­/å°æ–¹æ­£åœ¨è¼¸å…¥ã€çš„æ„Ÿè¦ºï¼Œæˆ–ç›´æ¥æ¸²æŸ“
        
        // 1. Meta æ³¡æ³¡
        let html = `
            <div class="chat-bubble bubble-meta" style="animation-delay: 0ms;">
                <div class="meta-row">
                    <span>${d.date}</span>
                    <span>${d.broker} ${d.analyst}</span>
                </div>
                <div class="meta-big">${d.company} ${d.code}</div>
                <div class="meta-sub">${d.rating} Â· ç›®æ¨™åƒ¹ ${d.target}å…ƒ ${d.prevTarget ? `<span style='font-size:12px;color:#999'>(å‰æ¬¡${d.prevTarget})</span>` : ''}</div>
            </div>
        `;

        // 2. é‡é»æ‘˜è¦æ³¡æ³¡
        html += `
            <div class="chat-bubble bubble-summary" style="animation-delay: 100ms;">
                <div style="font-weight:bold; margin-bottom:8px;">ğŸ’¡ æŠ•è³‡å¿«è©•</div>
                <div style="line-height:1.6;">${d.summary}</div>
            </div>
        `;

        // 3. è©³ç´°é‡é»æ¢åˆ—æ³¡æ³¡ (Ellis Style)
        let pointsHtml = d.contentPoints.map((p, i) => `
            <div class="point-item">
                <div class="point-icon">${i+1}</div>
                <div class="point-text">${p}</div>
            </div>
        `).join('');

        html += `
            <div class="chat-bubble bubble-content" style="animation-delay: 200ms;">
                <h3>Research Highlights</h3>
                ${pointsHtml}
            </div>
        `;

        container.innerHTML = html;
        this.go('detailView');
    },

    // --- å¤–é›»æ¸²æŸ“ ---
    renderNews: function() {
        const el = document.getElementById('news-content');
        el.innerHTML = DB_NEWS.map(n => `
            <div class="news-card-lg">
                <div class="news-source-row">
                    <div class="news-logo" style="background:${n.source==='Bloomberg'?'#2563eb':'#000'}">${n.source.slice(0,1)}</div>
                    <span class="news-name">${n.source}</span>
                    <span class="news-time">${n.time}</span>
                </div>
                <div class="news-main-title">${n.title}</div>
                <ul class="news-points">
                    ${n.points.map(p => `<li class="news-point">${p}</li>`).join('')}
                </ul>
                <div class="sentiment-tag ${n.sentiment==='Positive'?'sent-pos':''}">
                    ${n.sentiment==='Positive' ? 'â–² çœ‹å¤š' : 'â— ä¸­ç«‹/è§€å¯Ÿ'}
                </div>
            </div>
        `).join('');
    },

    // --- ç”¢æ¥­æœå°‹ ---
    searchInd: function(val) {
        const res = document.getElementById('ind-result');
        if(!val) { res.innerHTML = ''; return; }
        
        const hits = DB_IND.filter(x => (x.code+x.name).includes(val));
        if(hits.length === 0) {
            res.innerHTML = '<div style="text-align:center; color:#999">ç„¡è³‡æ–™</div>';
            return;
        }
        
        res.innerHTML = hits.map(d => `
            <div class="hero-card card-ind" style="height:auto; margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
                    <span style="font-size:20px; font-weight:bold; color:#065f46">${d.name} ${d.code}</span>
                    <span style="background:#10b981; color:white; padding:2px 8px; border-radius:12px; font-size:12px;">${d.main}</span>
                </div>
                <div style="font-weight:bold; color:#059669; margin-bottom:8px;">ğŸ† ${d.pos}</div>
                <div style="color:#4b5563; font-size:14px;">${d.desc}</div>
            </div>
        `).join('');
    }
};

app.init();
</script>
</body>
</html>
