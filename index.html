<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Rex æŠ•è³‡æ±ºç­– (æ‰‹æ©Ÿæ¥µé€Ÿç‰ˆ)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
    :root {
        --bg-body: #f4f5f7;
        --card-bg: #ffffff;
        --primary: #4f46e5;
        --text-dark: #111827;
        --text-gray: #6b7280;
        --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
        --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
        --safe-area-bottom: env(safe-area-inset-bottom);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
        font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif;
        background: var(--bg-body);
        color: var(--text-dark);
        margin: 0;
        padding-bottom: calc(60px + var(--safe-area-bottom)); /* é¿é–‹åº•éƒ¨å°èˆª */
        overscroll-behavior-y: none; /* é˜²æ­¢ä¸‹æ‹‰åˆ·æ–°å¹²æ“¾ */
    }

    /* === è¦–åœ–ç®¡ç† (è§£æ±ºå¡é “é—œéµ) === */
    .view { 
        display: none; 
        width: 100%; 
        min-height: 100vh; 
        padding-bottom: 80px;
    }
    .view.active { 
        display: block; 
        animation: fadeIn 0.2s ease-out; 
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

    /* === 1. Header === */
    .header-sticky {
        position: sticky; top: 0; z-index: 100;
        background: rgba(255,255,255,0.95);
        backdrop-filter: blur(10px);
        box-shadow: 0 1px 5px rgba(0,0,0,0.05);
    }
    .header-row {
        padding: 12px 16px; 
        display: flex; justify-content: space-between; align-items: center;
    }
    .app-title { font-size: 20px; font-weight: 800; color: #111827; }
    
    /* æ©«å‘åŠŸèƒ½åˆ— */
    .nav-scroll {
        display: flex; gap: 8px; padding: 0 16px 12px; 
        overflow-x: auto; scrollbar-width: none;
    }
    .nav-scroll::-webkit-scrollbar { display: none; }
    
    .nav-pill {
        flex-shrink: 0; padding: 6px 14px; background: #f0f2f5; border-radius: 20px;
        font-size: 13px; font-weight: 600; color: #6b7280; cursor: pointer; transition: 0.2s;
    }
    .nav-pill.active { background: #111827; color: #fff; }
    
    /* === 2. é¦–é ç€‘å¸ƒæµ (æ‰‹æ©Ÿå„ªåŒ–ç‰ˆ) === */
    .grid-container {
        padding: 16px; /* å…©å´ç•™ç™½ */
        display: grid; 
        grid-template-columns: 1fr 1fr; /* é›™æ¬„ */
        gap: 12px; /* é–“è· */
    }
    
    .card {
        background: #fff; border-radius: 12px; padding: 12px;
        box-shadow: var(--shadow-sm); position: relative;
        display: flex; flex-direction: column;
        border: 1px solid rgba(0,0,0,0.03);
        height: auto; /* è‡ªå‹•é«˜åº¦ï¼Œä¸å¼·åˆ¶æ‹‰å¤§ */
        min-height: 140px;
    }
    
    /* æ”¶è—æ„›å¿ƒæŒ‰éˆ• */
    .btn-fav {
        position: absolute; top: 8px; right: 8px; z-index: 10;
        width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
        font-size: 18px; color: #d1d5db; cursor: pointer;
    }
    .btn-fav.active { color: #ef4444; }

    .c-head { margin-bottom: 6px; padding-right: 20px; } /* paddingé¿å…æ“‹ä½æ„›å¿ƒ */
    .c-title { font-size: 16px; font-weight: 700; color: #111827; line-height: 1.2; }
    .c-code { font-size: 12px; color: #9ca3af; margin-top: 2px; }
    
    .c-badge { 
        display: inline-block; font-size: 10px; padding: 2px 6px; border-radius: 4px; 
        font-weight: 700; margin-bottom: 6px;
    }
    .bg-buy { background: #fee2e2; color: #ef4444; }
    .bg-hold { background: #fff7ed; color: #c2410c; }

    .c-body { 
        font-size: 13px; color: #374151; line-height: 1.4;
        overflow: hidden; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;
        flex-grow: 1; /* æ’é–‹ç©ºé–“ */
    }
    
    .c-foot { 
        margin-top: 8px; padding-top: 8px; border-top: 1px solid #f3f4f6;
        font-size: 11px; color: #9ca3af; display: flex; justify-content: space-between; align-items: center;
    }

    /* === 3. è©³æƒ…é  (æ•´é æ¨¡å¼) === */
    .detail-page { background: #fff; min-height: 100vh; position: relative; z-index: 200; }
    .detail-header {
        padding: 16px; border-bottom: 1px solid #f3f4f6; 
        position: sticky; top: 0; background: #fff; z-index: 10;
        display: flex; align-items: center; gap: 12px;
    }
    .back-arrow { font-size: 24px; color: #111827; cursor: pointer; padding: 0 8px; }
    
    .chat-container { padding: 20px 16px; display: flex; flex-direction: column; gap: 16px; }
    
    .bubble {
        background: #f9fafb; border-radius: 12px; padding: 16px;
        border-left: 4px solid transparent;
    }
    .b-meta { border-left-color: var(--primary); background: #fff; box-shadow: var(--shadow-sm); }
    .b-rex { background: #fffbeb; border: 1px solid #fcd34d; }
    
    .b-label { font-size: 11px; font-weight: 700; color: #9ca3af; margin-bottom: 6px; letter-spacing: 0.5px; }
    .b-text { font-size: 15px; line-height: 1.6; color: #1f2937; white-space: pre-line; }

    /* === 4. æœå°‹æ¡†æ¨£å¼ (å¤–é›»/ç”¢æ¥­) === */
    .search-wrap { padding: 0 16px 12px; background: #fff; }
    .search-input {
        width: 100%; padding: 10px 16px; border: none; 
        background: #f3f4f6; border-radius: 10px; 
        font-size: 15px; outline: none;
    }
    
    .list-item {
        background: #fff; padding: 16px; margin: 0 16px 12px; 
        border-radius: 12px; box-shadow: var(--shadow-sm);
        border-left: 4px solid #e5e7eb;
    }

    /* === 5. åº•éƒ¨å°èˆª (å›ºå®šæœ€ä¸Šå±¤) === */
    .bottom-nav {
        position: fixed; bottom: 0; left: 0; right: 0;
        background: rgba(255,255,255,0.98); border-top: 1px solid #e5e7eb;
        display: flex; justify-content: space-around; padding: 8px 0 calc(8px + env(safe-area-inset-bottom));
        z-index: 9999; /* ç¢ºä¿æœ€é«˜å±¤ç´š */
    }
    .nav-btn { 
        flex: 1; display: flex; flex-direction: column; align-items: center;
        color: #9ca3af; font-size: 10px; cursor: pointer; 
    }
    .nav-btn.active { color: var(--primary); }
    .nav-icon { font-size: 22px; margin-bottom: 2px; }

</style>
</head>
<body>

<div id="homeView" class="view active">
    <div class="header-sticky">
        <div class="header-row">
            <div class="app-title">Rex æŠ•è³‡æ±ºç­–</div>
            <div style="font-size:12px; color:#6b7280">æ‰‹æ©Ÿç‰ˆ v2.0</div>
        </div>
        <div class="nav-scroll">
            <div class="nav-pill active" onclick="app.filter('all', this)">å…¨éƒ¨</div>
            <div class="nav-pill" onclick="app.filter('high', this)">ğŸ”¥ é‡é»å ±å‘Š</div>
            <div class="nav-pill" onclick="app.filter('ai', this)">ğŸ¤– AI</div>
            <div class="nav-pill" onclick="app.filter('semi', this)">ğŸ­ åŠå°é«”</div>
        </div>
    </div>

    <div class="grid-container" id="feed-container"></div>
    <div style="text-align:center; padding:20px; color:#9ca3af; font-size:12px;">- å·²è¼‰å…¥æœ€æ–°è³‡æ–™ -</div>
</div>

<div id="favView" class="view">
    <div class="header-sticky">
        <div class="header-row"><div class="app-title">â¤ï¸ è‡ªé¸æ¸…å–®</div></div>
        <div style="padding:0 16px 12px; font-size:13px; color:#666">æ‚¨æ”¶è—çš„é—œæ³¨å€‹è‚¡</div>
    </div>
    <div class="grid-container" id="fav-container"></div>
    <div id="fav-empty" style="text-align:center; padding:40px; color:#999; font-size:14px; display:none;">
        å°šæœªæ”¶è—ä»»ä½•å ±å‘Š<br>è«‹é»æ“Šå¡ç‰‡å³ä¸Šè§’çš„æ„›å¿ƒ
    </div>
</div>

<div id="newsView" class="view">
    <div class="header-sticky">
        <div class="header-row"><div class="app-title">âš¡ å¤–é›»å¿«è¨Š</div></div>
        <div class="search-wrap">
            <input type="text" class="search-input" placeholder="æœå°‹å¤–é›» (ä»£è™Ÿ/é—œéµå­—)..." onkeyup="app.searchNews(this.value)">
        </div>
    </div>
    <div id="news-container" style="padding-top:12px;"></div>
</div>

<div id="indView" class="view">
    <div class="header-sticky">
        <div class="header-row"><div class="app-title">ğŸ­ ç”¢æ¥­ç™¾ç§‘</div></div>
        <div class="search-wrap">
            <input type="text" class="search-input" placeholder="æœå°‹ç”¢æ¥­å®šä½ (ä»£è™Ÿ/åç¨±)..." onkeyup="app.searchInd(this.value)">
        </div>
    </div>
    <div id="ind-container" style="padding-top:12px;"></div>
</div>

<div id="detailView" class="view" style="background:#fff; z-index:200;">
    <div class="detail-header">
        <div class="back-arrow" onclick="app.back()">âœ•</div> <div style="font-weight:700; font-size:16px;">æ·±åº¦è§£æ</div>
    </div>
    <div class="chat-container" id="detail-content"></div>
</div>

<div class="bottom-nav">
    <div class="nav-btn active" onclick="app.switchView('homeView', this)">
        <div class="nav-icon">ğŸ </div><div>é¦–é </div>
    </div>
    <div class="nav-btn" onclick="app.switchView('favView', this); app.renderFav();">
        <div class="nav-icon">â¤ï¸</div><div>è‡ªé¸</div>
    </div>
    <div class="nav-btn" onclick="app.switchView('newsView', this)">
        <div class="nav-icon">âš¡</div><div>å¤–é›»</div>
    </div>
    <div class="nav-btn" onclick="app.switchView('indView', this)">
        <div class="nav-icon">ğŸ­</div><div>ç”¢æ¥­</div>
    </div>
</div>

<script>
// === è³‡æ–™åº« (æ”¯æ´ Excel è®€å– + å…§å»ºæ¸¬è©¦è³‡æ–™) ===
let DB_REPORTS = [];
let DB_NEWS = [];
let DB_IND = [];
let FAVORITES = JSON.parse(localStorage.getItem('rex_fav_ids')) || [];

// å…§å»ºæ¸¬è©¦è³‡æ–™ (Fallback)
const TEST_REPORTS = [
    {
        id: "R001", company: "è¯ç¢©", code: "2357", date: "2025/11/19", broker: "å…ƒå¤§æŠ•é¡§", 
        rating: "è²·é€²", target: "700", imp: "é«˜", summary: "ä¼ºæœå™¨ç‡Ÿæ”¶ä½”æ¯”æ˜å¹´æŒ‘æˆ° 20%ï¼ŒGB200 å‡ºè²¨é †æš¢ã€‚",
        full: {
            fin: "3Q25 ç‡Ÿæ”¶ 1,899å„„ (QoQ+9%)ï¼ŒEPS 14.2å…ƒã€‚",
            ops: "1. ä¼ºæœå™¨ï¼šé è¨ˆ 2025 å¹´å€å¢ã€‚\n2. PCï¼šAI PC å¸‚å ç‡ 25%ã€‚",
            rex: "è¯ç¢©æ˜¯é€™æ³¢ AI ä¼ºæœå™¨è¢«ä½ä¼°çš„æ¨™çš„ï¼Œèµ·æ­¥æ™šä½†è¿½è¶•å¿«ï¼ŒNV é—œä¿‚ç·Šå¯†ã€‚",
            qa: "Q: GB200 å‡ºè²¨ï¼Ÿ A: 12æœˆå°é‡ï¼ŒQ1æ”¾é‡ã€‚"
        }
    },
    {
        id: "R002", company: "è‡´èŒ‚", code: "2360", date: "2025/11/18", broker: "æ‘©æ ¹å£«ä¸¹åˆ©", 
        rating: "å„ªæ–¼å¤§ç›¤", target: "520", imp: "ä¸­", summary: "SLT æ¸¬è©¦è¨­å‚™éœ€æ±‚å¼·å‹ï¼Œè¨‚å–®èƒ½è¦‹åº¦é” 2026ã€‚",
        full: {
            fin: "é ä¼° Q4 ç‡Ÿæ”¶å­£å¢ 15%ã€‚",
            ops: "AI æ™¶ç‰‡åŠŸè€—æå‡æ‹‰é•·æ¸¬è©¦æ™‚é–“ã€‚",
            rex: "è¨­å‚™è‚¡ç‹ã€‚æ¸¬è©¦æ™‚é–“æ‹‰é•·æ˜¯æœ€å¤§åˆ©å¤šï¼Œæ‹‰å›æ‰¾è²·é»ã€‚",
            qa: "Q: CoWoS æ“´ç”¢ï¼Ÿ A: æ­£å‘ã€‚"
        }
    }
];
const TEST_NEWS = [
    { src:"Bloomberg", date:"2025/11/19", co:"å°ç©é›»", code:"2330", title:"è‰¯ç‡è¶…è»Š", content:"äºåˆ©æ¡‘é‚£å» è‰¯ç‡å„ªæ–¼å°ç£å» å€ã€‚" },
    { src:"WSJ", date:"2025/11/18", co:"è¯ç™¼ç§‘", code:"2454", title:"å¤©ç’£ç†±éŠ·", content:"å—æƒ  Vivo æ–°æ©Ÿï¼Œå¸‚å ç‡æå‡ã€‚" }
];
const TEST_IND = [
    { n:"å°ç©é›»", c:"2330", i:"åŠå°é«”", p:"å…¨çƒæ™¶åœ“ä»£å·¥é¾é ­" },
    { n:"è¯ç¢©", c:"2357", i:"é›»è…¦é€±é‚Š", p:"ä¸»æ©Ÿæ¿ç¬¬ä¸€å¤§" }
];

const app = {
    lastView: 'homeView',

    init: async function() {
        try {
            await Promise.all([
                this.loadXLSX('reports.xlsx', 'report'),
                this.loadXLSX('news.xlsx', 'news'),
                this.loadXLSX('industry.xlsx', 'ind')
            ]);
            // æ’åºï¼šæœ€æ–°çš„åœ¨ä¸Šé¢ (æ—¥æœŸé™åº)
            DB_REPORTS.sort((a,b) => new Date(b.date) - new Date(a.date));
            DB_NEWS.sort((a,b) => new Date(b.date) - new Date(a.date));
            console.log("Excel Loaded");
        } catch (e) {
            console.log("Using Test Data");
            DB_REPORTS = TEST_REPORTS;
            DB_NEWS = TEST_NEWS;
            DB_IND = TEST_IND;
        }
        this.renderFeed(DB_REPORTS);
        this.renderNews(DB_NEWS);
        this.searchInd('');
    },

    loadXLSX: async function(url, type) {
        const resp = await fetch(url);
        if(!resp.ok) throw new Error("File not found");
        const ab = await resp.arrayBuffer();
        const wb = XLSX.read(ab, {type:'array'});
        const json = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]);
        
        if(type==='report') this.processReports(json);
        if(type==='news') this.processNews(json);
        if(type==='ind') this.processInd(json);
    },

    processReports: function(data) {
        DB_REPORTS = data.map((r, i) => ({
            id: r['ç·¨è™Ÿ'] || `R${i}`, company: r['å…¬å¸'], code: r['è‚¡è™Ÿ'], date: r['å ±å‘Šæ—¥æœŸ'],
            broker: r['åˆ¸å•†'], rating: r['æŠ•è³‡è©•ç­‰'], target: r['ç›®æ¨™åƒ¹'], imp: r['é‡è¦æ€§'],
            summary: r['ç²¾ç°¡é‡é»æ‘˜è¦'], tags: r['æ¨™ç±¤'] || "",
            full: {
                fin: r['é—œéµè²¡å‹™æ•¸æ“š'], ops: r['ç‡Ÿé‹é‡é»'], strat: r['ç­–ç•¥æ–¹å‘'],
                qa: r['é‡è¦QAæ‘˜è¦'], rex: r['Rexè§€å¯Ÿ'], follow: r['å¾ŒçºŒè¿½è¹¤']
            }
        }));
    },
    processNews: function(data) {
        DB_NEWS = data.map((r, i) => ({
            id: `N${i}`, src: r['åˆ¸å•†ä¾†æº'], date: r['æ—¥æœŸ'], co: r['å…¬å¸'], code: r['è‚¡è™Ÿ'],
            title: r['å ±å°é‡é»åˆ†é¡'], content: r['å®Œæ•´å ±å°å…§å®¹']
        }));
    },
    processInd: function(data) {
        DB_IND = data.map(r => ({ n: r['åç¨±'], c: r['ä»£è™Ÿ'], i: r['ç”¢æ¥­'], p: r['ç”¢æ¥­åœ°ä½'] }));
    },

    // --- é‚è¼¯å€ ---

    // 1. é¦–é å¡ç‰‡æ¸²æŸ“
    renderFeed: function(data, containerId = 'feed-container') {
        const el = document.getElementById(containerId);
        if(!data || data.length === 0) {
            el.innerHTML = "";
            if(containerId === 'fav-container') document.getElementById('fav-empty').style.display = 'block';
            return;
        }
        if(containerId === 'fav-container') document.getElementById('fav-empty').style.display = 'none';
        
        el.innerHTML = data.map(d => {
            const isFav = FAVORITES.includes(d.id);
            return `
            <div class="card" onclick="app.goDetail('${d.id}')">
                <div class="btn-fav ${isFav?'active':''}" onclick="event.stopPropagation(); app.toggleFav('${d.id}', this)">
                    ${isFav ? 'â™¥' : 'â™¡'}
                </div>
                <div class="c-head">
                    <div class="c-title">${d.company}</div>
                    <div class="c-code">${d.code}</div>
                </div>
                <div style="margin-bottom:6px;">
                    <span class="c-badge ${d.rating&&d.rating.includes('è²·')?'bg-buy':'bg-hold'}">${d.rating||'-'}</span>
                </div>
                <div class="c-body">${d.summary}</div>
                <div class="c-foot">
                    <span>${d.broker}</span>
                    <span style="font-weight:700">TP: ${d.target}</span>
                </div>
            </div>`;
        }).join('');
    },

    // 2. è‡ªé¸åŠŸèƒ½ (Favorites)
    toggleFav: function(id, btn) {
        if(FAVORITES.includes(id)) {
            FAVORITES = FAVORITES.filter(fid => fid !== id);
            btn.innerText = 'â™¡';
            btn.classList.remove('active');
        } else {
            FAVORITES.push(id);
            btn.innerText = 'â™¥';
            btn.classList.add('active');
        }
        localStorage.setItem('rex_fav_ids', JSON.stringify(FAVORITES));
        
        // å¦‚æœåœ¨è‡ªé¸é é¢ï¼Œç›´æ¥é‡ç¹ª
        if(document.getElementById('favView').classList.contains('active')) {
            this.renderFav();
        }
    },
    renderFav: function() {
        const favData = DB_REPORTS.filter(d => FAVORITES.includes(d.id));
        this.renderFeed(favData, 'fav-container');
    },

    // 3. è©³æƒ…é  (ä¸æœƒå¡ä½çš„æ•´é æ¨¡å¼)
    goDetail: function(id) {
        const d = DB_REPORTS.find(x => x.id == id);
        if(!d) return;
        const c = document.getElementById('detail-content');
        c.innerHTML = `
            <div class="bubble b-meta">
                <div class="b-label">ğŸ“Œ åŸºæœ¬è³‡è¨Š</div>
                <div style="font-size:18px; font-weight:700;">${d.company} ${d.code}</div>
                <div style="font-size:13px; color:#666; margin-bottom:8px;">${d.date} Â· ${d.broker}</div>
                <div style="display:flex; justify-content:space-between; border-top:1px solid #eee; padding-top:8px;">
                    <span style="color:#ef4444; font-weight:700">${d.rating}</span>
                    <span>TP: ${d.target}</span>
                    <span>${d.imp}é‡è¦</span>
                </div>
            </div>
            <div class="bubble"><div class="b-label">âš¡ æ‘˜è¦</div><div class="b-text">${d.summary}</div></div>
            <div class="bubble"><div class="b-label">ğŸ’° è²¡å‹™</div><div class="b-text">${d.full.fin||'-'}</div></div>
            <div class="bubble"><div class="b-label">ğŸ¢ ç‡Ÿé‹</div><div class="b-text">${d.full.ops||'-'}</div></div>
            <div class="bubble b-rex"><div class="b-label" style="color:#b45309">ğŸ‘‘ Rex è§€å¯Ÿ</div><div class="b-text" style="color:#78350f">${d.full.rex||'-'}</div></div>
            <div class="bubble"><div class="b-label">â“ QA</div><div class="b-text">${d.full.qa||'-'}</div></div>
        `;
        
        // åˆ‡æ›è¦–åœ–
        this.lastView = document.querySelector('.view.active').id;
        this.switchView('detailView', null); // null è¡¨ç¤ºä¸æ›´æ–°åº•éƒ¨å°èˆª
    },

    // 4. å¤–é›»æœå°‹èˆ‡æ¸²æŸ“
    searchNews: function(v) {
        if(!v) { this.renderNews(DB_NEWS); return; }
        const res = DB_NEWS.filter(n => (n.co+n.code+n.content).includes(v));
        this.renderNews(res);
    },
    renderNews: function(data) {
        const el = document.getElementById('news-container');
        el.innerHTML = data.map(n => `
            <div class="list-item" style="border-left-color:#f59e0b">
                <div style="font-size:12px; color:#d97706; font-weight:700; margin-bottom:4px;">${n.src} Â· ${n.date}</div>
                <div style="font-size:16px; font-weight:700; margin-bottom:4px;">${n.co} ${n.code}</div>
                <div style="font-size:14px; margin-bottom:6px;">${n.content}</div>
                <div style="font-size:12px; color:#999;">${n.title}</div>
            </div>
        `).join('');
    },

    // 5. ç”¢æ¥­æœå°‹
    searchInd: function(v) {
        const el = document.getElementById('ind-container');
        if(!v && v!=='') { el.innerHTML='<div style="text-align:center;color:#999;padding:20px">è«‹è¼¸å…¥é—œéµå­—</div>'; return; }
        
        const res = v===''? DB_IND.slice(0,20) : DB_IND.filter(d => (d.c+d.n).includes(v));
        
        if(res.length===0) { el.innerHTML='<div style="text-align:center;padding:20px">æŸ¥ç„¡è³‡æ–™</div>'; return; }
        el.innerHTML = res.map(d => `
            <div class="list-item" style="border-left-color:#059669">
                <div style="font-size:18px; font-weight:700; color:#047857">${d.n} ${d.c}</div>
                <div style="font-size:13px; color:#666; margin:4px 0;">${d.i}</div>
                <div style="background:#ecfdf5; padding:8px; border-radius:8px; font-size:14px; color:#065f46">ğŸ† ${d.p}</div>
            </div>
        `).join('');
    },

    // é€šç”¨åˆ‡æ›
    switchView: function(id, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
        
        if(btn) {
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
    },
    back: function() {
        this.switchView(this.lastView || 'homeView');
        // æ¢å¾©åº•éƒ¨å°èˆªç‹€æ…‹
        if(this.lastView === 'homeView') document.querySelectorAll('.nav-btn')[0].classList.add('active');
    },
    filter: function(type, btn) {
        document.querySelectorAll('.nav-pill').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        
        let res = DB_REPORTS;
        if(type==='high') res = DB_REPORTS.filter(d => d.imp==='é«˜'); // é‡é»å ±å‘Šé‚è¼¯
        if(type==='ai') res = DB_REPORTS.filter(d => (d.tags+d.summary).includes('AI'));
        if(type==='semi') res = DB_REPORTS.filter(d => (d.tags+d.summary).includes('åŠå°é«”'));
        
        this.renderFeed(res);
    }
};

// å•Ÿå‹•
app.init();
</script>
</body>
</html>
